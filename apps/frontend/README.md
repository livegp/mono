# @mono/frontend

üåç [**–ß–∏—Ç–∞—Ç–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é**](README.ua.md)

Frontend for the Mono project, built with React, Vite, and Bun. This application interacts with the `@mono/backend` API to provide a user interface.

## Table of Contents

- [About The Project](#about-the-project)
- [Built With](#built-with)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
- [Usage](#usage)
  - [Development Mode](#development-mode)
  - [Building for Production](#building-for-production)
  - [Running Production Build](#running-production-build)
  - [Type Checking](#type-checking)
- [API Interaction](#api-interaction)
- [Configuration](#configuration)
  - [Environment Variables](#environment-variables)
- [Vite Configuration](#vite-configuration)
- [Docker](#docker)
  - [Development with Docker](#development-with-docker)
  - [Production with Docker](#production-with-docker)
- [Project Structure](#project-structure)
- [License](#license)

## About The Project

This project serves as the frontend user interface for the Mono application. It is developed using React and Vite, running on the Bun runtime. It focuses on providing a modern, responsive, and efficient user experience.

Key features include:

- Reactive UI components built with React.
- Fast development and build times powered by Vite and Bun.
- Typed API client for interaction with the backend using Eden Treaty.
- Environment variable management with validation.
- Comprehensive Vite plugin ecosystem for optimization, security, and developer experience.

## Built With

- [Bun](https://bun.sh/) - JavaScript runtime & toolkit
- [Vite](https://vitejs.dev/) - Frontend build tool
- [React](https://react.dev/) - JavaScript library for building user interfaces
- [TypeScript](https://www.typescriptlang.org/) - Typed JavaScript
- [@ap0nia/eden-react-query](https://www.npmjs.com/package/@ap0nia/eden-react-query) (Eden Treaty with React Query) - Typed API client for Elysia.js backend
- [@tanstack/react-query](https://tanstack.com/query/latest) - Data-fetching and state management
- [Valibot](https://valibot.dev/) - Schema validation (used for environment variables)
- Various Vite plugins (see [Vite Configuration](#vite-configuration) section)

## Getting Started

Follow these instructions to get a copy of the project up and running on your local machine for development and testing purposes.

### Prerequisites

Ensure you have [Bun](https://bun.sh/docs/installation) installed on your system.

### Installation

1. Clone the monorepo (if you haven't already).
2. Navigate to the frontend directory:

    ```bash
    cd apps/frontend
    ```

3. Install dependencies:

    ```bash
    bun install
    ```

## Usage

### Development Mode

To run the frontend development server with hot-reloading:

```bash
bun run dev
```

This command starts the Vite development server. The application will typically be accessible at the URL specified by `VITE_WEB_URL` or `http://localhost:<VITE_WEB_PORT>`. Check the console output for the exact URL.

### Building for Production

To build the application for production:

```bash
bun run build
```

This command uses Vite to create an optimized build in the `dist/` directory.

### Running Production Build

After building the project, you can preview the production build locally:

```bash
bun run preview
```

This command uses Vite to serve the `dist/` folder. For actual production deployment, you would typically use the Docker image or serve the static files from the `dist/` directory with a production-grade static file server.

### Type Checking

To check for TypeScript errors without emitting JavaScript files:

```bash
bun run check-types
```

## API Interaction

The frontend interacts with the `@mono/backend` API using a typed client generated by Eden Treaty, integrated with React Query via `@ap0nia/eden-react-query`.

- The Eden client is initialized in `src/lib/eden.ts`.
- It connects to the backend API, typically defined by `VITE_API_URL` and `VITE_API_PORT`.
- An example of its usage can be found in `src/App.tsx`, where it fetches a greeting message from the `/api/greet` endpoint.

## Configuration

### Environment Variables

The application uses environment variables for configuration. These are loaded by Vite and validated using `@julr/vite-plugin-validate-env` with a schema defined in `config/env.ts` using Valibot.

Create a `.env` file in the `apps/frontend` directory. You can base it on `.env.example` if one exists, or create it from scratch.

Key environment variables:

- `VITE_WEB_PORT`: The port for the Vite development server (e.g., `5173`).
- `VITE_WEB_URL`: The base URL for the web application (e.g., `http://localhost:5173`).
- `VITE_API_PORT`: The port where the backend API is running (e.g., `3001`).
- `VITE_API_URL`: The base URL for the backend API (e.g., `http://localhost`).
- `VITE_CORS_ORIGIN`: Allowed origins for CORS, typically matching `VITE_WEB_URL`.

Example `.env` file:

```env
VITE_WEB_PORT=5173
VITE_WEB_URL=http://localhost:5173
VITE_API_PORT=3001
VITE_API_URL=http://localhost
VITE_CORS_ORIGIN=http://localhost:5173
```

## Vite Configuration

The `vite.config.ts` file configures the Vite build tool and its plugins. Key plugins used include:

- `@vitejs/plugin-react-swc`: Enables React support using SWC.
- `vite-tsconfig-paths`: Allows using TypeScript path aliases.
- `vite-plugin-checker`: Performs TypeScript and Biome (linter/formatter) checks during development.
- `vite-plugin-compression`: Compresses assets (e.g., gzip, brotli) for smaller bundle sizes.
- `vite-imagetools`: Optimizes images and allows for advanced image transformations.
- `vite-plugin-bun-csp` / `vite-plugin-csp-guard`: Helps generate Content Security Policy (CSP) headers.
- `vite-plugin-hashed-favicons`: Generates favicons for various platforms and a web manifest file.
- `vite-plugin-open-graph`: Adds Open Graph meta tags for better social media sharing.
- `vite-plugin-sitemap`: Generates a `sitemap.xml` file.
- `vite-plugin-svg-spritemap`: Creates an SVG spritemap from individual SVG files.
- `vite-plugin-webfont-dl`: Downloads and embeds web fonts from services like Google Fonts.
- `@julr/vite-plugin-validate-env`: Validates environment variables against a defined schema.
- **Server Proxy:** Configures a proxy for API requests (e.g., `/api` to `VITE_API_URL:VITE_API_PORT`) during development to avoid CORS issues.

## Docker

This project includes Dockerfiles for containerizing the frontend application.

### Development with Docker

The `Dockerfile.dev` is configured for a development environment:

- Uses the `oven/bun:latest` base image.
- Copies `package.json`, `bun.lockb`, `packages/` and `apps/frontend/`.
- Installs dependencies using `bun install`.
- The default command is `bun run --cwd apps/frontend dev` to start the Vite development server.

To build and run:

```bash
# From the monorepo root (h:\Fullstack\My\Bun\mono)
docker build -t mono-frontend-dev -f ./apps/frontend/Dockerfile.dev .
docker run -p 5173:5173 -v ./apps/frontend/src:/app/apps/frontend/src mono-frontend-dev
```

(Adjust port mapping and volume mounts as needed.)

### Production with Docker

The `Dockerfile.prod` is used to build a production-ready image for the frontend:

- **Stage 1 (Builder):**
  - Uses `oven/bun:latest`.
  - Copies necessary files and installs dependencies.
  - Builds the frontend application using `bun run --cwd ./apps/frontend build`. The output is in `/app/apps/frontend/dist`.
- **Stage 2 (Runner):**
  - Uses the slimmer `oven/bun:slim` base image.
  - Copies the `dist` directory from the builder stage.
  - Installs `serve` (a static file server).
  - The default command is `bun x serve dist --listen 0.0.0.0:3000` to serve the static files.

To build and run:

```bash
# From the monorepo root (h:\Fullstack\My\Bun\mono)
docker build -t mono-frontend-prod -f ./apps/frontend/Dockerfile.prod .
docker run -p 80:3000 mono-frontend-prod
```

(Adjust port mapping as needed. You might also need to pass environment variables if your static build relies on them at runtime, though typically they are baked in at build time for frontend apps.)

## Project Structure

A brief overview of the key directories and files in `apps/frontend/`:

```tree
mono/apps/frontend/
‚îú‚îÄ‚îÄ .gitignore          # Specifies intentionally untracked files that Git should ignore.
‚îú‚îÄ‚îÄ 404.html            # Custom 404 page, often used for SPA routing on services like GitHub Pages.
‚îú‚îÄ‚îÄ Dockerfile.dev      # Docker configuration for the development environment.
‚îú‚îÄ‚îÄ Dockerfile.prod     # Docker configuration for the production environment.
‚îú‚îÄ‚îÄ README.md           # This file (English documentation).
‚îú‚îÄ‚îÄ README.ua.md        # Ukrainian version of this file.
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ env.ts          # Schema definition for environment variable validation (Valibot).
‚îú‚îÄ‚îÄ index.html          # Main HTML entry point for the Vite application.
‚îú‚îÄ‚îÄ package.json        # Project metadata, dependencies, and scripts.
‚îú‚îÄ‚îÄ public/             # Static assets that are copied directly to the build output.
‚îÇ   ‚îî‚îÄ‚îÄ vite.svg        # Example static asset.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ App.css         # CSS styles for the main App component.
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx         # Main React application component.
‚îÇ   ‚îú‚îÄ‚îÄ assets/         # Static assets like images, icons, fonts.
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icons/      # SVG icons (e.g., for spritemaps or favicons).
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ img/        # Image files.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ react.svg   # React logo asset.
‚îÇ   ‚îú‚îÄ‚îÄ index.css       # Global CSS styles.
‚îÇ   ‚îú‚îÄ‚îÄ lib/            # Utility functions, libraries, or client configurations.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ eden.ts     # Eden Treaty client setup for backend API interaction.
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx        # Main entry point for the React application (renders the root component).
‚îÇ   ‚îî‚îÄ‚îÄ vite-env.d.ts   # TypeScript definitions for Vite-specific environment variables.
‚îú‚îÄ‚îÄ tsconfig.app.json   # TypeScript configuration specific to the application code (src).
‚îú‚îÄ‚îÄ tsconfig.json       # Root TypeScript configuration, often referencing other tsconfig files.
‚îú‚îÄ‚îÄ tsconfig.node.json  # TypeScript configuration for Node.js-specific files (e.g., vite.config.ts).
‚îî‚îÄ‚îÄ vite.config.ts      # Vite build tool configuration.
```

## License

This project is licensed under the MIT License. See the [LICENSE](../../LICENSE.md) file in the monorepo root for details.

**What this license allows:**

- Commercial use
- Modification
- Distribution
- Private use
- Sublicensing

**Limitations:**

- No liability
- No warranty
